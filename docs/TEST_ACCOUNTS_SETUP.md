# æµ‹è¯•è´¦å·é…ç½®æŒ‡å—

## æ¦‚è¿°

ä¸ºäº†ä¿æŠ¤éšç§ï¼Œæµ‹è¯•è´¦å·ä¿¡æ¯å­˜å‚¨åœ¨ç‹¬ç«‹çš„é…ç½®æ–‡ä»¶ä¸­ï¼Œè¯¥æ–‡ä»¶å·²æ·»åŠ åˆ° `.gitignore`ï¼Œä¸ä¼šè¢«æäº¤åˆ° Git ä»“åº“ã€‚

## é…ç½®æ­¥éª¤

### 1. å¤åˆ¶ç¤ºä¾‹é…ç½®æ–‡ä»¶

```bash
cp test_accounts.json.example test_accounts.json
```

### 2. ç¼–è¾‘é…ç½®æ–‡ä»¶

æ‰“å¼€ `test_accounts.json` æ–‡ä»¶ï¼Œå¡«å…¥çœŸå®çš„æµ‹è¯•è´¦å·ï¼š

```json
{
  "accounts": [
    "your_account_1",
    "your_account_2"
  ]
}
```

**æ³¨æ„**ï¼š
- è‡³å°‘éœ€è¦é…ç½® 1 ä¸ªè´¦å·
- å»ºè®®é…ç½® 2 ä¸ªè´¦å·ä»¥æµ‹è¯•è´¦å·åˆ‡æ¢åŠŸèƒ½
- è´¦å·ä¿¡æ¯ä¼šè¢«ç”¨äºé›†æˆæµ‹è¯•

### 3. éªŒè¯é…ç½®

è¿è¡Œæµ‹è¯•éªŒè¯é…ç½®æ˜¯å¦æ­£ç¡®ï¼š

```bash
pytest tests/test_auto_dungeon_integration.py::TestSwitchAccountIntegration -v
```

## æ–‡ä»¶è¯´æ˜

### test_accounts.jsonï¼ˆç§æœ‰æ–‡ä»¶ï¼‰

- **ä½ç½®**ï¼šé¡¹ç›®æ ¹ç›®å½•
- **ç”¨é€”**ï¼šå­˜å‚¨çœŸå®çš„æµ‹è¯•è´¦å·
- **Git çŠ¶æ€**ï¼šå·²æ·»åŠ åˆ° `.gitignore`ï¼Œä¸ä¼šè¢«æäº¤
- **æ ¼å¼**ï¼šJSON æ ¼å¼

```json
{
  "accounts": [
    "account1",
    "account2"
  ]
}
```

### test_accounts.json.exampleï¼ˆç¤ºä¾‹æ–‡ä»¶ï¼‰

- **ä½ç½®**ï¼šé¡¹ç›®æ ¹ç›®å½•
- **ç”¨é€”**ï¼šé…ç½®æ–‡ä»¶æ¨¡æ¿
- **Git çŠ¶æ€**ï¼šä¼šè¢«æäº¤åˆ°ä»“åº“
- **æ ¼å¼**ï¼šJSON æ ¼å¼ï¼ŒåŒ…å«å ä½ç¬¦

## å®‰å…¨æ³¨æ„äº‹é¡¹

### âœ… å®‰å…¨åšæ³•

1. **ä¸è¦æäº¤çœŸå®è´¦å·**ï¼š
   - `test_accounts.json` å·²æ·»åŠ åˆ° `.gitignore`
   - åªæäº¤ `test_accounts.json.example` æ¨¡æ¿æ–‡ä»¶

2. **æœ¬åœ°ä¿ç®¡**ï¼š
   - çœŸå®è´¦å·ä¿¡æ¯åªå­˜åœ¨äºæœ¬åœ°
   - ä¸è¦é€šè¿‡ä»»ä½•æ–¹å¼åˆ†äº«é…ç½®æ–‡ä»¶

3. **å®šæœŸæ£€æŸ¥**ï¼š
   ```bash
   git status
   ```
   ç¡®ä¿ `test_accounts.json` ä¸åœ¨å¾…æäº¤åˆ—è¡¨ä¸­

### âŒ é¿å…çš„åšæ³•

1. **ä¸è¦ç¡¬ç¼–ç è´¦å·**ï¼š
   ```python
   # âŒ é”™è¯¯åšæ³•
   accounts = ["15371008673", "18502542158"]
   
   # âœ… æ­£ç¡®åšæ³•
   accounts = load_test_accounts()
   ```

2. **ä¸è¦åœ¨ä»£ç ä¸­ç›´æ¥å†™è´¦å·**ï¼š
   - æ‰€æœ‰è´¦å·ä¿¡æ¯éƒ½åº”è¯¥ä»é…ç½®æ–‡ä»¶è¯»å–
   - ä¸è¦åœ¨æµ‹è¯•ä»£ç ä¸­ç¡¬ç¼–ç è´¦å·

3. **ä¸è¦æäº¤åŒ…å«çœŸå®è´¦å·çš„æ–‡ä»¶**ï¼š
   - æäº¤å‰æ£€æŸ¥ `git diff`
   - ç¡®ä¿æ²¡æœ‰æ„å¤–æäº¤æ•æ„Ÿä¿¡æ¯

## ä½¿ç”¨ç¤ºä¾‹

### åœ¨æµ‹è¯•ä¸­ä½¿ç”¨

```python
from tests.test_auto_dungeon_integration import load_test_accounts

# åŠ è½½æµ‹è¯•è´¦å·
accounts = load_test_accounts()

# ä½¿ç”¨ç¬¬ä¸€ä¸ªè´¦å·
if accounts:
    test_account = accounts[0]
    switch_account(test_account)
```

### åœ¨ä»£ç ä¸­ä½¿ç”¨

```python
import json

def load_accounts():
    """åŠ è½½è´¦å·é…ç½®"""
    with open('test_accounts.json', 'r', encoding='utf-8') as f:
        config = json.load(f)
        return config.get('accounts', [])

accounts = load_accounts()
```

## æ•…éšœæ’é™¤

### é—®é¢˜1ï¼šæ‰¾ä¸åˆ°é…ç½®æ–‡ä»¶

**é”™è¯¯ä¿¡æ¯**ï¼š
```
âš ï¸ æœªæ‰¾åˆ°é…ç½®æ–‡ä»¶: /path/to/test_accounts.json
ğŸ’¡ è¯·å¤åˆ¶ test_accounts.json.example ä¸º test_accounts.json å¹¶å¡«å…¥çœŸå®è´¦å·
```

**è§£å†³æ–¹æ¡ˆ**ï¼š
```bash
cp test_accounts.json.example test_accounts.json
# ç„¶åç¼–è¾‘ test_accounts.json å¡«å…¥çœŸå®è´¦å·
```

### é—®é¢˜2ï¼šé…ç½®æ–‡ä»¶æ ¼å¼é”™è¯¯

**é”™è¯¯ä¿¡æ¯**ï¼š
```
âŒ é…ç½®æ–‡ä»¶æ ¼å¼é”™è¯¯: Expecting value: line 1 column 1 (char 0)
```

**è§£å†³æ–¹æ¡ˆ**ï¼š
1. æ£€æŸ¥ JSON æ ¼å¼æ˜¯å¦æ­£ç¡®
2. ç¡®ä¿ä½¿ç”¨ UTF-8 ç¼–ç 
3. éªŒè¯ JSON è¯­æ³•ï¼š
   ```bash
   python -m json.tool test_accounts.json
   ```

### é—®é¢˜3ï¼šæ²¡æœ‰å¯ç”¨çš„æµ‹è¯•è´¦å·

**é”™è¯¯ä¿¡æ¯**ï¼š
```
æ²¡æœ‰å¯ç”¨çš„æµ‹è¯•è´¦å·
```

**è§£å†³æ–¹æ¡ˆ**ï¼š
1. ç¡®ä¿ `test_accounts.json` ä¸­è‡³å°‘æœ‰ä¸€ä¸ªè´¦å·
2. æ£€æŸ¥ `accounts` æ•°ç»„ä¸ä¸ºç©ºï¼š
   ```json
   {
     "accounts": [
       "account1"
     ]
   }
   ```

## æµ‹è¯•è¦†ç›–

ä½¿ç”¨é…ç½®æ–‡ä»¶çš„æµ‹è¯•ï¼š

1. **test_switch_account_real_device**
   - ä½¿ç”¨ç¬¬ä¸€ä¸ªè´¦å·æµ‹è¯•åˆ‡æ¢åŠŸèƒ½

2. **test_switch_account_execution_time**
   - ä½¿ç”¨ç¬¬ä¸€ä¸ªè´¦å·æµ‹è¯•æ‰§è¡Œæ—¶é—´

3. **test_switch_account_multiple_calls**
   - ä½¿ç”¨æ‰€æœ‰è´¦å·ï¼ˆæœ€å¤š2ä¸ªï¼‰æµ‹è¯•å¤šæ¬¡åˆ‡æ¢

## æœ€ä½³å®è·µ

1. **å›¢é˜Ÿåä½œ**ï¼š
   - æ¯ä¸ªå¼€å‘è€…ç»´æŠ¤è‡ªå·±çš„ `test_accounts.json`
   - ä¸è¦å…±äº«çœŸå®è´¦å·ä¿¡æ¯

2. **CI/CD ç¯å¢ƒ**ï¼š
   - åœ¨ CI ç¯å¢ƒä¸­ä½¿ç”¨ç¯å¢ƒå˜é‡æˆ–å¯†é’¥ç®¡ç†
   - ä¸è¦åœ¨ CI é…ç½®ä¸­ç¡¬ç¼–ç è´¦å·

3. **å®šæœŸæ›´æ–°**ï¼š
   - å®šæœŸæ£€æŸ¥è´¦å·æ˜¯å¦æœ‰æ•ˆ
   - åŠæ—¶æ›´æ–°å¤±æ•ˆçš„è´¦å·

4. **å¤‡ä»½**ï¼š
   - æœ¬åœ°å¤‡ä»½é…ç½®æ–‡ä»¶
   - ä¸è¦ä¾èµ–å•ä¸€å‰¯æœ¬

## ç›¸å…³æ–‡ä»¶

- `.gitignore` - åŒ…å« `test_accounts.json` çš„å¿½ç•¥è§„åˆ™
- `test_accounts.json.example` - é…ç½®æ–‡ä»¶æ¨¡æ¿
- `tests/test_auto_dungeon_integration.py` - ä½¿ç”¨é…ç½®çš„æµ‹è¯•æ–‡ä»¶

## æ›´æ–°æ—¥å¿—

- 2025-01-09: åˆå§‹ç‰ˆæœ¬ï¼Œæ·»åŠ æµ‹è¯•è´¦å·é…ç½®åŠŸèƒ½

